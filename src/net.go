package src

import "math"

type Network struct {
	Layers   []int
	Weights  []float64
	Biases   []float64
	NodesLen int
	K        float64
}

func NewNetwork(layers []int) Network {
	weightsLen := 0
	prevLayerLen := 0
	nodesLen := 0
	for _, layerLen := range layers {
		weightsLen += layerLen * prevLayerLen
		prevLayerLen = layerLen
		nodesLen += layerLen
	}

	biasesLen := 0
	// Skip first layer, it's input layer. It has no biases.
	for i := 1; i < len(layers); i++ {
		biasesLen += layers[i]
	}

	return Network{
		Layers:   layers,
		Weights:  make([]float64, weightsLen),
		Biases:   make([]float64, biasesLen),
		NodesLen: nodesLen,
		K:        3,
	}
}

func (net Network) NewNodes() []float64 {
	return make([]float64, net.NodesLen)
}

func (net Network) Evaluate(b Board, nodes []float64) float64 {
	if b.IsWhiteTurn() {
		for i := Pos(0); i < 32; i++ {
			nodes[i] = value(b.Get(i), net.K)
		}
	} else {
		for i := 31; i >= 0; i-- {
			nodes[31-i] = -value(b.Get(Pos(i)), net.K)
		}
	}

	var sum float64
	for i := Pos(0); i < 32; i++ {
		sum += nodes[i]
	}

	prevOffset := 0
	nodesOffset := 32
	weightIndex := 0
	biasIndex := 0
	for l := 1; l < len(net.Layers); l++ {
		for i := 0; i < net.Layers[l]; i++ {
			a := .0
			for p := 0; p < net.Layers[l-1]; p++ {
				a += nodes[prevOffset+p] * net.Weights[weightIndex]
				weightIndex++
			}
			a += net.Biases[biasIndex]
			biasIndex++

			// Inject sum of input values to last layer.
			if l == len(net.Layers)-1 {
				a += sum
			}

			// Activation function.
			nodes[nodesOffset+i] = math.Tanh(a)
		}
		prevOffset = nodesOffset
		nodesOffset += net.Layers[l]
	}

	rate := nodes[len(nodes)-1]

	if b.IsBlackTurn() {
		rate = -rate
	}

	return rate
}

func value(p Piece, k float64) float64 {
	switch p {
	case Empty:
		return 0
	case WhiteMan:
		return 1
	case BlackMan:
		return -1
	case WhiteKing:
		return k
	case BlackKing:
		return -k
	default:
		panic("invalid piece")
	}
}

var NetZero = NewNetwork([]int{32, 40, 10, 1})

var NetHeiOay = func() Network {
	net := NewNetwork([]int{32, 40, 10, 1})
	net.Weights = []float64{
		63.81044624682337,
		27701.03941071028,
		43.90181456384284,
		-4247.274069637217,
		4949.258197051254,
		-0.8735102405835816,
		1.4883958493868992,
		934.9194003107243,
		-0.2444982164557708,
		-203.4664151210768,
		606352.2921624959,
		-5.195703070099933,
		-3.853249482019737,
		-1.6981407015745205,
		982823.3248640702,
		-2.754598516806753,
		63473405.86873553,
		-8009.983557458729,
		21.06142416496108,
		361394508826.1282,
		-541346036.9403228,
		1344.9617558156274,
		-1035.7692334429235,
		-589.0556117018391,
		210679.53969096625,
		-14.315980752324169,
		721.5661743678605,
		-39.19637896417879,
		-0.04044393094590929,
		-9571.852543769834,
		-2378.7757603953664,
		-77848467.5659525,
		0.33109760926570403,
		-9219.547434532045,
		155832.98222277884,
		0.4039264591705673,
		-0.949728155066779,
		-4.112580381342594,
		-417.523650101071,
		-0.3537711324818073,
		-12.611096740092716,
		-1868684.893448324,
		-107.62160661425551,
		-0.052992884976634604,
		-30733.565409641615,
		212684.05695163953,
		12.548523531131183,
		-2170480141.6148434,
		5.264370770716304,
		15.456493838601755,
		-6.145399601612295,
		-7367074.180615944,
		2.6921603953145,
		-101.23952814947778,
		6089896.123552428,
		-5.201071418764627,
		-0.822397976227504,
		543.9911191012125,
		475424.8215289765,
		-2676.662376095983,
		4.141866563418858,
		72.81380211987118,
		100073.86418386849,
		-11984.843542761155,
		-8.968826303808687,
		-1453672.189594411,
		-20.45151185846525,
		0.5971898376347158,
		1.7287027401123296,
		-0.5646163317846449,
		21.71725480214522,
		-2187.304378192193,
		-12.84048224145171,
		0.9932676693585331,
		-14.04682935049866,
		668.5449178997526,
		1030.3343682781376,
		4.83925726597387,
		-65.76813427399435,
		0.9258105821040669,
		-8879.504956397892,
		24237.27682910043,
		-21433.241817647133,
		-0.5493809233879681,
		-1496.345549059053,
		-4724194.6547868885,
		-34.074584524172536,
		-0.018831393441300324,
		8.875580665130368,
		560783792008.1265,
		-7.685367006496967,
		2.601288050674287,
		2511.852031918665,
		-9934.247198334702,
		147.85420446876677,
		-438.83354184577695,
		-1986679.868399341,
		0.9784585873446592,
		63493.13050815084,
		20809.41186743151,
		122972.2889304566,
		690.1690407917828,
		-110801.77680102295,
		32.88912780376923,
		36.58529868019487,
		-0.05762559262506434,
		3803051.9048651494,
		-245808.62536459294,
		201239633.66707897,
		4948981684.406944,
		-0.32939138783418764,
		11.779661021602381,
		6.724096687540772,
		-60.141650150971344,
		4.282890932951901,
		-61.43911595982675,
		3.3528905609039508,
		-9.113821800524107,
		-8053818.964673589,
		223.74309121771665,
		-315.664003521026,
		955.6116115788872,
		37.60195918347341,
		0.7919000241307218,
		1.6699543414044873,
		-565.2039991697594,
		358.30062304337446,
		21505.679977084823,
		4.36641681669242,
		53411.41331580172,
		-14570.596871623033,
		-18.193221358550932,
		232.90696456132915,
		47.66708334192361,
		275.89852888179354,
		2.623363022116321,
		-77492.84790659035,
		67.130911419054,
		1.6343002430625009,
		-1595.0577312827998,
		0.5979103746293198,
		-0.19828307468389855,
		84.25861469382963,
		-11281.686486207445,
		1718896.7389533804,
		-0.3868264225693773,
		-3.5584656681212254,
		-10.675791401873564,
		4324.901429695027,
		24.136314136314198,
		-55352704.9265334,
		6291.647688757108,
		-1134.4426835976392,
		-0.159479658018033,
		-1.0237611554187587,
		-3.273277291563343,
		-111.26989434167749,
		-16.595834048532645,
		-7377.588264765178,
		10.083619577388111,
		17.198300248593736,
		567.7781359249146,
		-9.644787203934527,
		2.011075045949091,
		-15.02125109161158,
		-0.8254757650083083,
		-22.458782422368824,
		-8184.824780667612,
		-2.690653593654657,
		0.4653830341401262,
		-1.1359995925765498,
		-3.0100506916432277,
		-16.89642483287424,
		-2.295231098150881,
		2.1434857552481588,
		6.6977919738260665,
		-187558.68423871242,
		-3717.80247980822,
		0.05150621816389553,
		109.8355970517202,
		-1.8465445492207593,
		1502.4115636591575,
		645.4550447717158,
		-830220.3736087106,
		-60.927280418380725,
		30.50297445591217,
		28.77135201391246,
		-5347.774628984079,
		1865.2191070005267,
		486.7756100107758,
		-0.49854129415617576,
		44002592.34572428,
		-1.5046290484058056,
		141.19000736350569,
		0.9940402511578311,
		638069.1710943289,
		-428.6288279116919,
		6.0462849792155815,
		-578.3952515147736,
		11.820139953095127,
		-2.409074625814727,
		-1.938522676925296,
		119463.0159242167,
		-4.7363269771455885,
		-6.288785931314846,
		-1.7547032309070043,
		6.428175385264005,
		567318.8098379738,
		32.596193561390066,
		-29.034643636450795,
		2.8616415952534267,
		-67.84306247605598,
		-1.0298858383603489,
		27.663753001792877,
		0.5447473325861384,
		-20.708853405406156,
		51.75172787620579,
		-45654.63491461805,
		27.53792443004022,
		-380.3276521005133,
		-1798.3926227099787,
		-856.0122393569127,
		-6.275715497770624,
		-84947.78333143212,
		2.857461602956698,
		6511.31016980215,
		33.03717089496695,
		-26.20233734181983,
		-33160.19594325188,
		-0.46825200325149335,
		12.780879468022146,
		-538.2815524701124,
		-598663.7194856926,
		2.221654582339118,
		0.5989505403999001,
		-993.3415342730137,
		-2353276.182617858,
		-36155.92950801125,
		1.2806398202932534,
		-5351143.293846888,
		216117360.67478126,
		2.345318122852262,
		337009.3281401653,
		0.9916553968547216,
		1.8616950761184727,
		41688.44658006779,
		0.06618686767909901,
		-251.8355999481016,
		23.690443510681266,
		11.199802815058838,
		31.46207257922848,
		-0.03978871352872557,
		-3743.260870362488,
		0.5173643780387982,
		-1423.4704165174307,
		-4.439812565234942,
		0.22431335951397968,
		0.43529106356453867,
		3.5045741250772906,
		-43.32728728419711,
		12.16285135853366,
		-8.920869245491183,
		49.33070450937018,
		-7322.839814413271,
		-10.004616712349867,
		67.79759682005474,
		-3.375817126783887,
		4631.213393304456,
		-46494.81153934289,
		-13491.853528259422,
		-5.21920237968253,
		-1.8045446276105197,
		86472139.96167672,
		-97837.95921489915,
		5524.721496579119,
		2212.396496650147,
		-1.303946071584533,
		-3866136.6711248797,
		-384283.02799382166,
		765.9031889105969,
		-0.008576264737869602,
		-10.084458439630541,
		-13823.70006952876,
		9600.878326646698,
		349362134.2542647,
		-1.2755246599211396,
		-136.1062084668414,
		-34.94206500944551,
		1.1444805202164767,
		-19790021.811522428,
		-171.25635924931206,
		1483.32155982117,
		10.758625201094082,
		-4.040966278505599,
		405.8826455437944,
		-23.250196448752103,
		-345.5267746145619,
		-2.1900866425032683,
		1.0024415144712744,
		369.8648802806863,
		-2739.454070674569,
		-46.07855390003312,
		-4975625.491618187,
		77.38215867394833,
		-2.0850993947595575,
		-4.285837340282249,
		34.98057313536334,
		0.4435153440905381,
		18908.74750916752,
		36154.94397261925,
		0.6518513511684543,
		93.41893466450703,
		-13.789972226304364,
		135.98451619297805,
		-4.335252779448061,
		-0.3297972079168893,
		-52609.03898985243,
		213541.64179523027,
		28.66502555918836,
		-15.15551611654767,
		41.62917464252355,
		588933341.7590516,
		74242.13982372714,
		-6.1273757299870555,
		451.92204533564126,
		53.512279670744185,
		642.9782107183547,
		8.29990373464911,
		-3.0062216174922933,
		-25.966817422187027,
		519720.6111455825,
		-9396.901411775667,
		-0.1421883525729342,
		0.1674001204889913,
		-1.7815449646860988,
		-22.963037691752646,
		49770.83811337261,
		-956.9115057968075,
		-0.4327261755625511,
		0.7492357023584826,
		-43485.56785855397,
		0.009187432316101161,
		0.08407181608172709,
		-16.41053621545333,
		-0.7474068611712792,
		-671.9219140737041,
		142.7002627873203,
		63.65515658229768,
		-15.13788705107806,
		-96356.2820397893,
		124.17182250729226,
		-7.337625300002678,
		7.992798279456844,
		-34.55049362256496,
		-1594.1701979903544,
		-1.1072668817622717,
		-727661.0911884253,
		0.7755391233726976,
		35.01674319036896,
		1376.558643899836,
		-0.49834445738257604,
		-10.31455104842164,
		8.562638391233543,
		80.07219065339011,
		-6018251.630443666,
		15962095076.8308,
		0.4300236407089178,
		-1315894.8873492768,
		-3.967414225697356,
		0.09711244099465333,
		6.828476350421129,
		-0.5571175857862568,
		268.37955715230464,
		-623.1683873214537,
		9987.590700779529,
		0.15467448656203264,
		-14142818.581868814,
		-0.5037000187867257,
		30922.36248598282,
		-1223.6053680985121,
		925.2052871114462,
		1.3520164349528982,
		11.384964485602904,
		1175.7352154380685,
		68264122.54837075,
		-25.430862672309203,
		4.676928416606016,
		0.19944214339649294,
		20098.506949637576,
		4.735111955304028,
		12.652575631380394,
		1861.9639549264073,
		-43.669334903654494,
		82.01211000831098,
		19.67691076022597,
		-414.3846261667154,
		-0.0717494232488806,
		4877.574484974441,
		6.076541181665022,
		-6244.695243105324,
		57.386819423199675,
		30680.68081702946,
		0.8096333134796672,
		2236430.3344496903,
		2.898841457311184,
		4.78000602116874,
		1049.7085625270702,
		-1.197061112325409,
		-1788595.7387645163,
		-0.24623894425181803,
		-19.711730418916012,
		20241.225351973408,
		44.81223858576372,
		37990.95010074048,
		0.04003193674489613,
		4816819.931151113,
		-8.734288702825005,
		-24.00664204897968,
		0.0681752628897061,
		3.5436793680934064,
		662.6277282291057,
		-34.699550304197466,
		-0.291567610585467,
		0.09229198137611334,
		0.17772369305843408,
		173400.73459632634,
		-112.57586463554344,
		0.4940564831532243,
		55.11369007310984,
		-957.721401555474,
		-1.5849695649587585,
		22.032334751758885,
		1.6042351157569803,
		23613.702910280634,
		-71326.07794778702,
		1.650211967974523,
		-7.548527377082688,
		-6.121138821173792,
		4.0605860463429675,
		-7152.751779679224,
		537521.6395147628,
		114.35323693164638,
		-134.67637164005404,
		-3183.2411871257573,
		0.0008300759303315861,
		26.24307734416324,
		-1.2954955169904718,
		51453.47878291454,
		-53.88051033170466,
		-2640966.561232965,
		412.7109420345039,
		-605.7615008351644,
		876.0065210493563,
		-3.2922961301372435,
		265440.55630018323,
		265711.88661862345,
		2.6883995739682764,
		2.9156290320045937,
		-0.6105188128705036,
		-0.027944752901933146,
		-1754.6959498300146,
		27.583324126208606,
		402.2807309594388,
		-129039.4154477729,
		1416.9726663162442,
		0.4652509698534455,
		-641089.0095341098,
		91.94383315339272,
		1.263339755594267,
		-5.521097200915256,
		42.69973585040719,
		0.022789806068593,
		-228.24497964111777,
		-4426.782215679227,
		-34.81887281593811,
		69.0172288751258,
		6560.384409311682,
		-8.879696273763072,
		-0.3831654710824417,
		20.8118498388606,
		3.798769195220101,
		-0.020557079769408727,
		-21.15896781199214,
		-32749.10975204567,
		-25.60000185905222,
		-72.1410002754379,
		-157148.0843108188,
		0.6093281400290945,
		1729634015938.0447,
		-25.22467333342561,
		14.053649742328904,
		1236.807346500359,
		-71.75956571731822,
		0.5624048788256467,
		51.83665628684379,
		1942348.388472259,
		-148.7386394941093,
		-1.707248993294819,
		-25901.501558889893,
		-1450.469030674112,
		-622.7176512808101,
		4.634398312924737,
		-45989.90840404137,
		0.48394655185503754,
		5560.831585313487,
		-284.0191281700083,
		2.0699517182653935,
		6.822263945001275,
		250.56315799821348,
		273.77329963615585,
		-445.84170055126225,
		-0.31885343244439923,
		-2.5811043062503063,
		-1.3175296871620419,
		104837.92750372044,
		88.23086382958327,
		430.89105201253614,
		-302.68498214271153,
		-168226.3194223954,
		-31.996371160263003,
		515.8150683246397,
		-2.6286943790336372,
		35.735808151209994,
		-1255074.8322258813,
		-333.4498772661999,
		-369.44978877651704,
		-19.608821898771964,
		46.49150063672577,
		4.887680970325191,
		3949.4541750148483,
		-0.31917473458135387,
		-537.6567475364569,
		-294275.658721667,
		-26207752.44342125,
		29.788599113314714,
		-3535.8795798343576,
		-3.045383566971418,
		-96.91871061393701,
		49374121.0150002,
		-45.31362320116447,
		17467.857274665403,
		-162.30202676859253,
		-7.850911550723965,
		6055.6742612148055,
		-2.7119714863884945,
		485.4086332968403,
		119.75351562116515,
		-54.801138838415184,
		180.30900146571807,
		-7051.261809529913,
		-1.4640929749354452,
		78655211.03299838,
		-0.5503813076217934,
		-603.3977862201472,
		1.5432585028919616,
		-36890.93626164313,
		10.641475858443277,
		240782.6124807067,
		482.5922000732014,
		5091.632518471264,
		3.6547819164742146,
		2018.163886596244,
		0.05572715759771404,
		22.616159744481024,
		-6870.057714645877,
		-237597.67596069467,
		104683.71660098188,
		-121.12459786429847,
		335.28090293881866,
		118.36168987276181,
		235.40746710684593,
		-1107.9333876801868,
		0.29669016369244977,
		-226.584418931214,
		-265.002549430707,
		0.7477136548965706,
		-13.311803620437562,
		-8.279827528982146,
		2592.025851243463,
		-4088.2766302920004,
		-24.65751265486316,
		12.96331938903492,
		767.1038825428941,
		-10.843873830618245,
		1.646865780253096,
		1108.1296505883147,
		18.6748762958363,
		-1512.3425900546827,
		-1975609.3588898217,
		-14.969329773846495,
		-3701874.195862246,
		693.811706733185,
		-474.55860887971204,
		-10.778578049308951,
		-333.17281331247733,
		-295353.3070592202,
		2.4864180711689254,
		-47.97243590691767,
		-0.04298991965839379,
		-13.729376245742795,
		1975872.0477726667,
		-325208.1770412975,
		28.07112838804941,
		65.8467734170991,
		-15.728922309479042,
		-1.544266589250037,
		-1627.7430687463425,
		-714.3616683560753,
		191.61527496068692,
		14834.68082527822,
		-2860143.1925826864,
		-40663.77705238516,
		-2.0001748628111753,
		1.3233708259597505,
		-4148453.2923729797,
		-0.9517034811876157,
		-6987.06468277904,
		-0.33327084413721847,
		31000.30205646221,
		22.354940272923542,
		3.289860576237916,
		13185.79121585182,
		6231034.041306201,
		-4.422288962454573,
		14874.045369706675,
		363.7978292571761,
		-6.1733768764005745,
		-597.3404370919081,
		-84.44619893148534,
		4694.730263673105,
		-2.2212804230568,
		-9546.770082255905,
		-2.008246084484283,
		-90980.7548178682,
		11.4125126046765,
		9.80435004010036,
		-0.4615480384010599,
		-48.67783571216161,
		-18.54344597822041,
		11172.905666535522,
		6249.686163877553,
		-2.569883529911361,
		8923653.457018381,
		32227.128787605405,
		-51.406979821069186,
		16.748585069115872,
		-2726468.559441136,
		2402082.625479158,
		-1.0122411710952415,
		7275.628579226094,
		-8.365340397080761,
		-0.17762461176084268,
		10952.848512547278,
		14.234438359692167,
		-397.5534984929563,
		3920.631533204083,
		-50.6388167475224,
		-1.0920140088788064,
		27.224728675924446,
		78.82727389806475,
		160.77136123413118,
		-13976934.732830111,
		4.593480143370053,
		-8845.365429679627,
		0.4795525629242682,
		-0.08996128076360471,
		-0.30590361333127375,
		-215.5358026378721,
		118.79975203081797,
		4936.059927324733,
		93186211.18005604,
		-9.33019863634417,
		-2.250192190007563,
		-0.2576451216616881,
		0.3797735804194994,
		5.33517670617603,
		-9.268269881809944,
		-8921.527303795707,
		17.08462595315208,
		-621.9359316643857,
		-21.871434691383897,
		3.7807014402094374,
		0.027993762251032398,
		-11.883429207253275,
		1914.5656169865981,
		1.9844262948839586,
		0.2852187870619795,
		-0.5116084628221073,
		-0.3675405535055478,
		97.5189950831526,
		-1774631223.386535,
		-55.929251297820386,
		2727.955064900176,
		-0.016747966681890263,
		3.4213969502450583,
		-2440237.058166994,
		-7972.440564555905,
		-0.4036135150725322,
		3914.394228180058,
		1.5764272805706478,
		3770812.485425862,
		-12043.63594972304,
		-289.5957644880225,
		-3.2327323812806172,
		-95.41284159288138,
		-1.05739935289107,
		118.93555200181007,
		-2472.69015728554,
		-0.5740523476966121,
		9.982810506756728,
		-9.151890680594345,
		-276.43638917478825,
		4209.164603338209,
		0.48569748276891267,
		346.3603556020093,
		-1076.359778920257,
		933.8382052736271,
		31.008583698871362,
		-146808.05606280803,
		0.0003175096657507462,
		-3.5965781714387743,
		12.885030104531848,
		2.8969726684467196,
		1379968.9984683427,
		6.229517096160362,
		-248.84479129434143,
		39218682.82239949,
		3247461.6734085483,
		3.267981098218727,
		-7.582065308132195,
		-109.85485056292401,
		7049.865335001411,
		-802518.1021002651,
		7.629300408037733,
		13.556746189035207,
		22472.950965446515,
		0.3928609540269867,
		-28460605.06681766,
		0.2717881047829201,
		-317.8037508600216,
		1935.6198878547812,
		43673.79894920939,
		0.6053098662760175,
		88.86893488659081,
		235.67763377197585,
		-33496.73582102409,
		2603821.260625212,
		-0.37874435629836956,
		-0.18151644701561065,
		1.4617128049619115,
		27566.374742578948,
		0.5064937727399582,
		4.705309511681352,
		-227.77754315260037,
		0.24590423630978533,
		120.02578999951547,
		-5.806013608338029,
		0.25035393316321797,
		1.7880454685520708,
		-2.0982799757120976,
		-25082.813417276415,
		-2006.7323373060517,
		14293646.202086931,
		-61.295299521794576,
		18.06826333040909,
		-698.3298056421177,
		8.555217849979442,
		-8077.357334356956,
		-5.469507320583776,
		3492.9560961054895,
		-6.785915525927617,
		0.04982919938194585,
		69.41085507932904,
		-3.2026128733927144,
		-1.91983380963051,
		-5.752809403294855,
		25.722443435800017,
		-0.34357591398135146,
		25502749.928661995,
		-1.8647799977143367,
		69332.40537181508,
		-57989.38088406383,
		-13.528289478799525,
		-0.7600158917454447,
		2201.008952432529,
		147882.62009249907,
		-0.10864227760020535,
		5.88183690728892,
		1.854399660422113,
		-126.38802649882095,
		-8954.26782919558,
		-1112.9609495713205,
		1753.3211045408175,
		14699.80960217167,
		-279.76801524541895,
		0.3194097720499265,
		-3.325784374605545,
		-6.359581591488221,
		-56.75520816906916,
		0.4054582890498618,
		1704.458740183177,
		33.474374144345916,
		-31.338547016141494,
		-1.8329883938980192,
		1037.7635743091703,
		-4.518631484210612,
		1004774.422657247,
		-0.38267208037382083,
		-73130.12387119835,
		-245.82708983467256,
		-36585.85363360018,
		-44.64038116582711,
		9.22132037080382,
		-6095.7724079311,
		-0.36848323548984346,
		11428.711381951462,
		-0.14849424549072648,
		-1.107444537628984,
		13571300976.965086,
		-0.34412382844227785,
		-11.80685620010159,
		-4.82729222315006,
		2032.1888078011414,
		-92.5055645171316,
		6478.6141458308075,
		-30.729252904421017,
		79.58531556955512,
		32.63383938397983,
		104687563.33073378,
		-860675.226070264,
		-26534048.681880563,
		-928.3316661007653,
		-0.7488089079582106,
		67356.74080145289,
		39.61602080904843,
		-24.45107581937133,
		13.611296175439538,
		-2.529589326889647,
		1.4764294485856264,
		-0.036714986108669787,
		446.11439356108593,
		487228.5788751996,
		-4710.155059166304,
		-7743.7321000683105,
		92741287162.95691,
		17.01302218502102,
		-4695.635176120299,
		117291156.11938915,
		7.121891182673862,
		-10.21822888458264,
		1762.3301593613,
		0.31107266016308976,
		4.420661831062248,
		0.13116797628912474,
		-52.72601525863934,
		-161255.02721762145,
		478.9753230289386,
		35570482.65247272,
		327133.13475420163,
		-23.99780875220468,
		-18.968495264871184,
		-0.028820045017476176,
		-17187.071966237112,
		144.37111021476562,
		-1.7992315663721985,
		0.06897166202723139,
		0.2488483013952669,
		20.38351696690164,
		2.486347713073995,
		-0.3960683283621122,
		-38.369805795673635,
		39146689.80640705,
		115005.22574150779,
		505229.3266474718,
		28.903997583106623,
		14208.649764957376,
		-0.956115193560871,
		-32.65583039860215,
		-0.00698020845332224,
		4.338250873550532,
		5.733335247392242,
		102.01995020547203,
		0.3806041343563552,
		1395.5789876039905,
		23145.54131133965,
		32.32616231054117,
		-1477505.2784449456,
		28581.205134664622,
		-116.89643958295632,
		814.205150875532,
		-381.47486820949877,
		-38.718932612856584,
		8.549320341567503,
		0.8952657699500511,
		-450.7486807380555,
		0.9115506823589757,
		71.49211590891365,
		-534.5179252181263,
		-23373560.732324224,
		-16502.51765384378,
		1.3834464929000823,
		299.7335675508698,
		0.22226342701540333,
		2355.7169141408704,
		-6248.300350954063,
		-1.7352052434834342,
		-0.23414875046470066,
		1.4991952348982152,
		-614.471540515271,
		-306.3747815406821,
		-0.24516623714621813,
		-152.3799466753038,
		4408173.4044694565,
		0.3296822963478374,
		-2141.5462120362995,
		-4.746656131586662,
		-0.2401577344977132,
		10.896644137821331,
		-0.3576036309544275,
		7.930984004364635,
		963.8821714443324,
		0.9302062506748697,
		271.71265547912066,
		5.662255545001931,
		704.5801216003804,
		-2.1186123823270635,
		-0.7047327590192448,
		-17.85904209638226,
		-630.8093410596038,
		2.811840797279233,
		-12.998721646911287,
		42744386.915814586,
		-4.453027683438697,
		337.70472032154197,
		0.6272602059973095,
		339802.6884318492,
		-3.076774534087139,
		-0.26101132623558787,
		0.29600080240196425,
		-346.1643550323553,
		10.9058757603333,
		-29044281.413348805,
		-0.2183230186625754,
		-2.160245435604105,
		2424.3844450726,
		-20222.20315181581,
		5.158360335415304,
		18621886.063864045,
		700.1135524599898,
		-1875839452.9774098,
		4.582572493773867,
		6780.974033849715,
		-0.8315064274222045,
		37640.987989558154,
		7.049283685137762,
		9571.438139822994,
		-1.1033969464386657,
		-0.5142233665779157,
		-37.434517993556796,
		-3.1914428549951825,
		5856.414495336392,
		-95.88629240272606,
		0.7621916808815071,
		-6.521973596786823,
		-4.728510161235332,
		1035.0393395023527,
		28.231874051505844,
		0.7448945951937831,
		182.896895011904,
		65.1363034075897,
		-44.167390550204686,
		47349.430476784044,
		-2292.2208104212077,
		4.036563853667012,
		26.10585024123855,
		9.010056785567214,
		-370.7034874853693,
		-0.7519221546073567,
		-14.897340138950131,
		675108.6218017436,
		-14.246628141931298,
		1.2793483410685278,
		-7.793954026902256,
		-53.640237691994884,
		1292.0019713454737,
		234.7700643811357,
		-63203.42154860754,
		36.53609353271779,
		58.891781312730636,
		142.21092583146577,
		-13.759680868844093,
		-8380.134266302379,
		124.43808859290243,
		-3932.8082794079837,
		-56.22939241417958,
		-13.302116336154898,
		341387.0293872056,
		75.29785167353235,
		-294.4575285471672,
		24701072.806826245,
		-5.136929291081932,
		-85.33284243270087,
		-1.9261597709416651,
		1802.6786627595804,
		3.2533189357701553,
		-8.288511612334261,
		218815.4515852833,
		-130.04840885735257,
		-15.219411511780716,
		370.8708101361118,
		438.1206397670984,
		-1518.8157973013701,
		4.3122707709720665,
		-27469737.769350354,
		-0.37107074082677005,
		-182469.7080717213,
		6.89790466060707,
		18439.34887484074,
		2.845336791800194,
		13.684616225222754,
		2.364369982635379,
		-1.1864546695823563,
		-1.7577656012410685,
		-548.3358579432015,
		-164.92362115256768,
		71.53134750757681,
		-0.6649619925111365,
		-1.1633717923656186,
		1.5595726026762666,
		-778.2419208257371,
		119830.87466006962,
		-753763.4972439386,
		42479479.770047955,
		0.20376908551115328,
		-946.0853538810312,
		8346.435042212453,
		21.437794188272143,
		74.23287852970012,
		485.7202682123101,
		-67163.262459791,
		61.08784520212041,
		30415606.913536467,
		14.891532526262983,
		-6.303718348973921,
		-13992.590707489297,
		-36009.01438131767,
		-9.846227351054639,
		401.96310297280996,
		-9569.922022991137,
		-0.0779938550318284,
		-256.8211164652406,
		178.48994483397342,
		63.115129534278815,
		9.656747725920578,
		25790.0083795389,
		1.9722446087134609,
		-1.084591955901791,
		-175.06579501799803,
		11638.80529493786,
		-923115.7458211462,
		-0.8794197447454902,
		2.208976011294307,
		-0.37622148419948864,
		1.4207423792670735,
		-178940.97274070574,
		-14.99315184706408,
		-1883.0778881370472,
		0.5332092659411886,
		-16.035080097795603,
		550242.7204267642,
		-76.01654429382502,
		-0.10056538617946968,
		-13.573367374489104,
		-11.054167181750675,
		-1.8979498234976284,
		11791.354606388839,
		142150436.9041916,
		-54.71606579353063,
		255.07284852226528,
		-8.10846824898404,
		-12.70368560132146,
		7.816823974903898,
		-16894.79986006565,
		1.0951690615199499,
		-10.474655191347814,
		9.369835758187802,
		7.8502344913006326,
		-0.5075617272815962,
		-4.719152849786943,
		-1561.8710194545208,
		9682016.663722511,
		-0.8498212810994962,
		58.9824320228892,
		-6640.902590592446,
		0.19076621695220325,
		-0.3844273543082268,
		-71348.40664642568,
		407266.23812361644,
		33.13698564612155,
		1285.1681680675638,
		-5.7068193604177955,
		-102919.76386917876,
		92206.47151117,
		-0.11795517528370801,
		-0.1566362890328034,
		-3301966.7388719027,
		-21.993531578863852,
		-1865912.5839117684,
		-58.131656302436625,
		3.2116069115988157,
		-3485.167042253876,
		1.4129145966117125,
		-5.661531381209975,
		-0.3247504592769593,
		-219.9747887834959,
		-0.5936340926093613,
		71524.25508212371,
		-16.22659284534754,
		-1.3948562962951858,
		39311435.87617646,
		-0.209260481070135,
		153.131314114694,
		-0.21156621711262805,
		-1.191309992884015,
		-14056.583560078969,
		28.478862367544977,
		-26974.90166114936,
		-306.2656489865483,
		-260.26641063302594,
		48117.264461538434,
		-35274114.508543156,
		-1357.031708448732,
		3.9022936464998406,
		1.0323035044780196,
		19.620881936205915,
		19.934552798537254,
		988.3312087640946,
		153.60333336001793,
		429.8817594179077,
		9.221850817563485,
		-0.36333487175722057,
		747013.9865932639,
		47.25926414520305,
		-31.796656535276576,
		63.143811112660444,
		-1362.4799315905937,
		-216712.8395724807,
		0.7302167505746255,
		-23.65295781068908,
		7081.515814770612,
		206.81091547858642,
		-11.329872317316852,
		-183.80046042065533,
		10088.352755013913,
		-43.90881647456482,
		1.6867968437540937,
		10861.670420996828,
		-1.2589610816894863,
		-1694.2627707109662,
		17050.318299360042,
		2.945576677904594,
		-1.2743845597753267,
		-155.92657471696523,
		-886.4715097799162,
		-12.631882998188889,
		67.85785516984777,
		15.206340187248665,
		-0.4422474495627483,
		-189965859.14888465,
		-389.99614274951625,
		4292.805861729215,
		18321196.043131888,
		0.5060774522639309,
		-0.7268382055947693,
		-0.5778219035360412,
		578.9631369832277,
		-38379325.253464356,
		-2.1944354040431406,
		-9.246671630574937,
		1.5529485166422934,
		335.89776865285717,
		1.3443032081551465,
		27.562871158759858,
		-10.156085628470102,
		-1603528.5538658656,
		-6591.949669260125,
		1492.4350463095775,
		-464.58636138916245,
		182456.32389161838,
		5.2428805556695055,
		158488.57453631298,
		387.82039830250017,
		7.436790797405249,
		-335795.41256227926,
		-6.622723908802128,
		3821.6727832371557,
		-1446.5528522759173,
		-289023.6484610348,
		10766727.408752639,
		151.23652559108444,
		576.0907905943611,
		-58.680568041032274,
		1895.9803778308662,
		1498.39635294609,
		4.119318306260534,
		-5.5973820936123015,
		0.9689180825828668,
		3.255091795402859,
		-7908.506659778362,
		-92.4118123892561,
		29.705455462393708,
		-118.46163212427918,
		-37.936414670438644,
		1.4641751587167262,
		220350.63605475696,
		-58.79928157438687,
		34293.61244322315,
		-1953.3348267208867,
		-27273.823493695858,
		-1316.126282511719,
		0.31458770229199484,
		-1.4980315086488913,
		66945.11368259387,
		-12.031042808458912,
		598282.876819836,
		-0.6306837189616812,
		-0.7332489892563114,
		-0.16316770203166023,
		0.8433102436768337,
		382.90110290130445,
		13650.30286207106,
		-49.371719433422534,
		-12.325393445788272,
		-31.955459223022725,
		5809247840.91193,
		-35057.444696249186,
		16.068503783549293,
		-2037.9130952118544,
		-1026.6298688076945,
		133940.89486890676,
		-81907.97538731156,
		-150.45506900108057,
		520.9419062359392,
		7473.287480672241,
		719.336976315691,
		2121423.9232277474,
		-145.038524109291,
		1433475.253309493,
		-403.9690707373028,
		372.51936919149,
		160.16316443231275,
		-8.779920135296365,
		505.63097674312246,
		15.323540319520458,
		-0.3923257572240893,
		-129.3881932909715,
		-9.162605548147377,
		121.60419115176893,
		403.97268573426965,
		0.19623341318571527,
		2516.349524668904,
		-4.732292310341353,
		-20.746778471421997,
		2.2902824958238273,
		275620.8331907199,
		38409.228975991886,
		-1465.4244237547573,
		6.235800688998204,
		984.6337542345261,
		3992.8866075217725,
		-19464.422969961794,
		-3.873370922336489,
		-4288.500748933866,
		86.8005054079393,
		0.14064121088363704,
		-4.6874261698485125,
		-117.46443327570162,
		2.158927338247499,
		1.0167517559818566,
		-81.86753924259796,
		1377528.9432104663,
		2.737884781504008,
		0.046243647410961965,
		-1212.9252208980317,
		0.24081823468328536,
		-0.06530324574884697,
		0.9319898803463642,
		-2265.1419942878397,
		-44.573509481011044,
		0.183735043204074,
		1.8043089922714868,
		-112507.4362298981,
		-1953968.7313674358,
		0.3905163276783854,
		0.3760242212301983,
		32698.201167574047,
		367.91634284529607,
		-15.74300542087807,
		-1.2064958167418243,
		2126.653240689093,
		823445.1603350444,
		0.2777424318448648,
		-47.05224728204238,
		-15978.981617032001,
		-283.9224120371895,
		115519.26075924172,
		-58.55474856776168,
		4.210604278813993,
		-2145.582028542378,
		0.4182529310134299,
		0.13811080678645665,
		-5.010449625605709,
		-130925.35169731786,
		2.842596464782563,
		1658.9242434049424,
		0.48042102415520277,
		20.089311072249487,
		263.69269796411317,
		89.69979392263679,
		-0.3465531812004653,
		-9.877526515598989,
		8.713032917385714,
		-3848946.9182754196,
		-0.4028322776140067,
		-1059957.3392382655,
		192096.88271852772,
		-9852.792464309416,
		-0.7306541331462894,
		194.5908994499237,
		8255.571405942772,
		-3.991266603577652,
		29307.458735776603,
		-758.8435617817527,
		1677.676112164301,
		16806.347437098742,
		14.317290728927766,
		56.55042828959845,
		70.94778359353744,
		0.34972151053370537,
		-0.27544202796423367,
		-151871.9472974915,
		55.48306283796152,
		-0.16679546201669165,
		1260.6611309779917,
		-0.11895263395360484,
		9.644056789257803,
		4714.912919816063,
		-1.068233685118315,
		-32.332329476691754,
		1.0191733922981991,
		-44.95638790940438,
		8956.806181489272,
		15235438.15325856,
		-14.9789360223178,
		-81091.46286076598,
		3.099316471383543,
		-5.063352810258556,
		104828.21736059392,
		450.00485164697835,
		2827674.234597035,
		202532.46555657926,
		-1585.8393634473455,
		19.68612636231942,
		6.05236991700596,
		-672613.1885434467,
		963.7020832535668,
		-3.4191258327977336,
		-25.521645940836443,
		-8.895723259968383,
		1.193895762926247,
		-6.569372472713776,
		-16.502926095788467,
		-66.6522742922268,
		291.89469390416247,
		-9409.908892106116,
		4999.275908182564,
		3270.4340261789507,
		40.29741822585247,
		-37001.0522976493,
		96629.40109165158,
		-0.2098178740423468,
		34.72000711311595,
		-1.9374283067442666,
		-836.5335129099354,
		0.2427714367410232,
		-135.55532020856785,
		-640.1877326562468,
		0.3262028644748697,
		-3.7850411396615744,
		-0.4722457139087334,
		-24.811555630383562,
		-6675.861760663666,
		15840.286273987082,
		0.10640093773859625,
		11826.386602411703,
		-0.4037671283295253,
		-6.182504333589962,
		-1394541.2589522507,
		34.32082906786857,
		-3842.2299874467803,
		11407793.983888924,
		-28.763338266827812,
		0.9621711694260061,
		-1107.4320083109187,
		-268.556931197629,
		865.4760692992171,
		-53.92762982160919,
		114.88888559392922,
		2690013.725194023,
		-113.19824850170596,
		420.7112088316975,
		52.63772553042587,
		145441.08993651345,
		-4733322.875545964,
		-27.985444303229137,
		1.8688311425142734,
		17059.78405853447,
		-3.253231722602503,
		1123.894094659048,
		0.26828467130742,
		368.67038541969646,
		0.16164576256903646,
		-4.2079672749154575,
		52.1124626459739,
		-1.019548595584373,
		-2.6476664641359404,
		-1.1735011485353455,
		13.083502497393871,
		5411.799410523469,
		5.459929189819418,
		-134759.25254835622,
		261787.11988295775,
		-98244.22824632986,
		0.19385515286616264,
		-15.196100352749548,
		-1.0311281842911049,
		-1353.1423606710798,
		20546.841104531093,
		-1557.5554552813494,
		1653.6136926879815,
		-2.240371660314129,
		-0.41440797193873613,
		0.37781920634810895,
		5.284284747548851,
		837.386484297518,
		229.80942089753722,
		-409291.1079186405,
		1.0461934187684092,
		-0.4451650867899926,
		-1.7980452725145286,
		1.2083248338584058,
		-144.01634808859905,
		2.12028888415576,
		853.5456343276455,
		6530.510495357751,
		8.573256731207884,
		2.6962512062780575,
		3633.4108026217777,
		-6.548174145044572,
		42.72742522631778,
		-56.251843544663615,
		-164482210.59337303,
		-57396.231796585846,
		0.47993787516681824,
		-5919549.891753511,
		-240.6457962930416,
		1376.6269636350928,
		1007.6471457030398,
		-1750.3120515220453,
		1.6418312268611501,
		9.369651445388465,
		0.3527612053462877,
		4311987.759982303,
		72116461.8815475,
		-18.40600805244015,
		35120157.80140146,
		-1.0433015018853344,
		5.195545775789692,
		1489.5393299911166,
		-1.8311755038378328,
		-0.9620350771524351,
		-317.6644320144349,
		-6.747805936909803,
		-1.1057293710038825,
		-29.018358005166903,
		-39.22144113134329,
		-0.13768787007862393,
		12.111543711118564,
		39185.91370413917,
		0.9467830576640279,
		-1279.9625881728607,
		526.2468998178206,
		-1844.5804412968562,
		36.24933124719512,
		-101.25124669411055,
		-0.565208980482434,
		5112.430830701306,
		-205.13304905414535,
		-0.3406153560614905,
		-81338.35034744268,
		-7.196918085528547,
		0.14289331262196642,
		-6.878637624607108,
		7.226386762510113,
		-15.25876948313803,
		0.8251658823578348,
		-63.79996572390599,
		1266.4220996175009,
		12945.982490713453,
		371.29701773529627,
		0.47190381576765206,
		-2.3692388118070076,
		-1.0208286791171284,
		-25.57206586847436,
		8.580685282326685,
		43.01955098304074,
		-40.04087123635133,
		-58614.63096471712,
		-27.90655238253825,
		2152.3135624524502,
		-22.801489423842085,
		142.19276625208408,
		13.103412378161424,
		-0.8481144428922645,
		4.389332660596077,
		4.158025227566798,
		-4.093861011460461,
		17.102386740226073,
		1.002278288783726,
		-0.6056014943383919,
		-12.257083373021446,
		3543.3846564216683,
		-108.08358673860248,
		-166.25818905989743,
		58.48466827224456,
		-96272.82772914895,
		24.15474564218375,
		4.342397806776598,
		4317.4912283783415,
		57520.546112003794,
		-3.9535620081442113,
		-117.97293646372566,
		-3.5655203087014082,
		2.0843820775568975,
		1848.2970871976813,
		1352.7151951792503,
		23.684915664671237,
		5.545689288460542,
		-4855.241112832572,
		23097.46714321432,
		763.3182677452937,
		1.9319306159322949,
		8.211779023417895,
		-277.1080382806843,
		-0.0995614762324182,
		4396.569818163966,
		40531.94172936707,
		-15.473281151945313,
		-225.6644551465503,
		37887.46875762672,
		198.72665685038137,
		2187.7914325984148,
		-7624539.015219465,
		-1398.1898401342705,
		17.278993167098164,
		0.3743095152397067,
		-3.2504707126566657,
		0.4180376564996425,
		5.3678918637740995,
		-3158.812581477077,
		-611.7533587929507,
		82.93361387810357,
		-0.7183841372742374,
		0.8904194209100041,
		-782315650.7833986,
		98.61754602040098,
		-45020.785088678225,
		-4333480.893305065,
		2.00578674690242,
		-1538.3994574927085,
		85.14839719811751,
		-4486391.0425019935,
		152333.89211498149,
		257.38647692588484,
		7015.7617642656,
		-25.33892505035851,
		-12.703515812970478,
		-129.1667641715352,
		1.1499283549389663,
		1.1000645342527524,
		27292.866824840246,
		57.7439056963214,
		42.32247959345295,
		11265.739662966369,
		-51.39212458430599,
		5.132957275478865,
		-1.374919009315048,
		2672.5057542527306,
		-27.982603254235684,
		176.35777598634587,
		59.0068618029109,
		-9553.621927838045,
		1.6917207857221446,
		-9811.894749816283,
		-77178.88978159575,
		-5.330067349526598,
		558.8320355116055,
		2538.5130155117945,
		2351.599943857765,
		-15447640.39672643,
		1.3684602816555993,
		-3264.8850547068732,
		-1.445235805478074,
		183306.14964503303,
		-902076.549555514,
		277.7801714085094,
		61.08240005549928,
		-2551.3056564710273,
		-1158.7719839063634,
		864.3639423642435,
		-0.2198997170145477,
		178862.94970409476,
		10790.913295775425,
		-240.87110525429563,
		-3.2870804593407703,
		-0.2886251103035824,
		324670.18883766135,
		-17.28310587881412,
		-90285.53355606852,
		2.3417150938537206,
		-0.9408590412912308,
		2.4033743832769763,
		4.3461044099139725,
		-22.307875390253738,
		63.376777507095156,
		149515.1262659369,
		290764.0809985729,
		-11533.019988723618,
		-2.360749251727963,
		-1281122.697172581,
		18.80725498751193,
		-8.154399725517068,
		28840.49619287149,
		-0.5510936607645314,
		75.02057098111875,
		-6.35085078745934,
		0.7511079232088976,
		-5.81433395523767,
		-15149.056244880276,
		-0.48039508695547734,
		-10016.004545219435,
		5.667214318802371,
		53.5520172275009,
		-28656741.564427707,
		4.407068086867724,
		-561367.5682560761,
		582.4999863030024,
		16297.41143803925,
		-64.97214626788697,
		-3332006.208449323,
		8.557742509272895,
		18.165023850977175,
		-3300.661895559,
		-18637.641135384187,
		-5.364552404728098,
		24174.029618095636,
		3.816036175457368,
		-940015.0214289357,
		8.648908231303402,
		-5280.844955743855,
		-2183023.479213158,
		21.77140530118542,
		-1.0701217200728106,
		-906875.896621653,
		-785.8997892015037,
		-534.3108264257454,
		1939.280644072722,
		21.660393294054224,
		-372.97609376301756,
		-0.6397870494049829,
		-0.06898421819301927,
		0.1524029000119014,
		0.09878682819079339,
		-0.0566240682779053,
		0.11062412859361781,
		-0.20088872216852444,
		0.27554939937012374,
		0.07174036411225387,
		-0.051837047336248346,
		0.06120196776995784,
	}
	net.Biases = []float64{
		-1046.2548309552433,
		-4.399797791998379,
		159.91865664124407,
		343.32527205186153,
		8319.275400613773,
		-8423.301420477577,
		-29.96175272154955,
		77.06104879407222,
		-3765438.509584002,
		2.929482426895261,
		-6.531021420683263,
		1.1862869586385505,
		-201675.36127953752,
		1684.535510874372,
		-78115.27985371888,
		-2.6135508501733464,
		-5.887467338681948,
		-198089.76837867033,
		526.6550708218329,
		-0.8582055269788103,
		-19.446216961460873,
		-3.1294112141042083,
		2.7437186767476827,
		27829648.0417924,
		-24506667.99178879,
		-4132.486704761477,
		0.20345734386792505,
		-6392.8398069616815,
		138.69704571844423,
		3364.88509827441,
		-18250383.138895713,
		-23.2892388261242,
		-49729.73786948982,
		6.1356246611418115,
		-374.81011630634663,
		0.4026908182016347,
		-0.5293383366668359,
		-1965.5789853720846,
		-61618686.97361994,
		-1.4744415031801976,
		31374.459751621842,
		-0.7672722446037524,
		-311.47141817141863,
		-0.2646734901342932,
		27346.84239439823,
		584.708857406667,
		-73.74209990038955,
		-0.8866928042442893,
		745.6204449254607,
		-542.3176877552112,
		0.28205558010662624,
	}
	net.K = 2.931425425354135
	return net
}()
